# This workflow will install Python dependencies, run tests and lint with a single version of Python ğŸ
# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-python ğŸ“š

name: Bangumi Anime ğŸš€

# è¡¨ç¤ºæ¯å½“æˆ‘ä»¬æ¨é€æäº¤ï¼ˆPush Commitsï¼‰æˆ–åˆå¹¶è¯·æ±‚ï¼ˆPull Requestï¼‰æ—¶,è¯¥å·¥ä½œæµä¼šè‡ªåŠ¨è§¦å‘æ‰§è¡Œã€‚â°
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  # æ¯å¤©ä¸Šåˆ5ç‚¹æ‰§è¡Œä¸€æ¬¡
  schedule:
    - cron:  '0 5 * * *'  # Cron è¡¨è¾¾å¼ ğŸ•°ï¸
  workflow_dispatch:
    
permissions:
  contents: write  # å…è®¸å·¥ä½œæµå†™å…¥ä»“åº“å†…å®¹ âœï¸

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4
    - name: Set up Python 3.10 ğŸ
      uses: actions/setup-python@v3
      with:
        python-version: "3.10"
    - name: Install dependencies ğŸ“¦
      run: |
        python -m pip install --upgrade pip
        # è‹¥ requirements.txt å­˜åœ¨
        if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
    - name: Generate svg ğŸ¨
      run: |
        python main.py
    - name: Upload to this repo ğŸ”¼
      run: |
        git config --global user.name "GitHub Actions"
        git config --global user.email "actions@github.com"
        git add .
        git commit -m "ğŸš€ Update SVG on $(date +'%Y-%m-%d')"
        git push -u origin main
      env:
        GIT_TOKEN: ${{ secrets.GITHUB_TOKEN }}  # ä½¿ç”¨é¢„å®šä¹‰çš„ GITHUB_TOKEN å¯†é’¥ ğŸ”‘
